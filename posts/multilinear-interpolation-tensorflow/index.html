<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Vicente Guerrero">
    <meta name="description" content="Vicente Guerrero&#39;s personal website">
    <meta name="keywords" content="blog,developer,personal,software">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Multilinear Interpolation in tensorflow"/>
<meta name="twitter:description" content="Extension of the tf.image.resize_bilinear to the N dimensional case  Visit the github repository for the full code.   
The function extends the functionality of tf.image.resize_bilinear for N dimensional Tensors.  
Strategy The strategy is fairly simple, tensors are interpolated two dimensions at a time using the already existant tf.image.resize_bilinear function.
[]  
Test   Building a 3D volume using a black image, an android image and a white image."/>

    <meta property="og:title" content="Multilinear Interpolation in tensorflow" />
<meta property="og:description" content="Extension of the tf.image.resize_bilinear to the N dimensional case  Visit the github repository for the full code.   
The function extends the functionality of tf.image.resize_bilinear for N dimensional Tensors.  
Strategy The strategy is fairly simple, tensors are interpolated two dimensions at a time using the already existant tf.image.resize_bilinear function.
[]  
Test   Building a 3D volume using a black image, an android image and a white image." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/multilinear-interpolation-tensorflow/" />
<meta property="article:published_time" content="2020-01-05T20:48:21+01:00" />
<meta property="article:modified_time" content="2020-01-05T20:48:21+01:00" />


    
      <base href="/posts/multilinear-interpolation-tensorflow/">
    
    <title>
  Multilinear Interpolation in tensorflow · Vicente Guerrero
</title>

    
      <link rel="canonical" href="/posts/multilinear-interpolation-tensorflow/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    

    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.62.0" />
  </head>

  
  
  <body class="colorscheme-light">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Vicente Guerrero
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/services/">Services</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/contact/">Contact me</a>
          </li>
        
      
      
        
        
        
          
        
          
            
              <li class="navigation-item menu-separator">
                <span>|</span>
              </li>
              
            
            <li class="navigation-item">
              <a href="/de-de/">Deutsch</a>
            </li>
          
        
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Multilinear Interpolation in tensorflow</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2020-01-05T20:48:21&#43;01:00'>
                January 5, 5050
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              2 minutes read
            </span>
          </div>
          
          
        </div>
      </header>

      <div>
        <h4 id="extension-of-the-tfimageresize-bilinear-to-the-n-dimensional-case">Extension of the tf.image.resize_bilinear to the N dimensional case</h4>
<hr>
<p>Visit the github repository for the full code.
<a href="https://github.com/viclule/image_resize_n_linear"><img src="/icons/github-icon.png" alt="GitHub"></a>
<br/>
<br/></p>
<p>The function extends the functionality of tf.image.resize_bilinear for N dimensional Tensors.
<br/>
<br/></p>
<h4 id="strategy">Strategy</h4>
<p>The strategy is fairly simple, tensors are interpolated two dimensions at a time using the already existant tf.image.resize_bilinear function.</p>
<p>[<img src="/images/posts/multilinear_interpolation_tensorflow_2.png" alt="Strategy">]
<br/>
<br/></p>
<h4 id="test">Test</h4>
<ol>
<li>
<p>Building a 3D volume using a black image, an android image and a white image. [1, 245, 206, 3, 4] [1 batch, height, width, depth, 4 channels]</p>
</li>
<li>
<p>Resize the 3D volume to [1, 100, 100, 5, 4]</p>
</li>
</ol>
<p>Expectations: [1, 100, 100, 2, 4] will be half way darker.</p>
<p>Expectations: [1, 100, 100, 4, 4] will be half way brighter.
<br/>
<br/></p>
<p>This is the image showing the results for the 3D test:
<br/>
<br/>
[<img src="/images/posts/multilinear_interpolation_tensorflow.png" alt="Test for 3D">]
<br/>
<br/></p>
<hr>
<h4 id="python-code">Python code</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> tensorflow <span style="color:#f92672">as</span> tf


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_resize_by_axis_trilinear</span>(images, size_0, size_1, ax):
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    Resize image bilinearly to [size_0, size_1] except axis ax.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        :param image: a tensor 4-D with shape </span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">                        [batch, d0, d1, d2, channels]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        :param size_0: size 0</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        :param size_1: size 1</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        :param ax: axis to exclude from the interpolation</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    </span><span style="color:#e6db74">&#34;&#34;&#34;</span>
    resized_list <span style="color:#f92672">=</span> []

    <span style="color:#75715e"># unstack the image in 2d cases</span>
    unstack_list <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>unstack(images, axis <span style="color:#f92672">=</span> ax)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> unstack_list:
        <span style="color:#75715e"># resize bilinearly</span>
        resized_list<span style="color:#f92672">.</span>append(tf<span style="color:#f92672">.</span>image<span style="color:#f92672">.</span>resize_bilinear(i, [size_0, size_1]))
    stack_img <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>stack(resized_list, axis<span style="color:#f92672">=</span>ax)

    <span style="color:#66d9ef">return</span> stack_img


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">resize_trilinear</span>(images, size):
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    Resize images to size using trilinear interpolation.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        :param images: A tensor 5-D with shape </span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">                        [batch, d0, d1, d2, channels]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        :param size: A 1-D int32 Tensor of 3 elements: new_d0, new_d1,</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">                        new_d2. The new size for the images.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    </span><span style="color:#e6db74">&#34;&#34;&#34;</span>
    <span style="color:#66d9ef">assert</span> size<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>
    resized <span style="color:#f92672">=</span> _resize_by_axis_trilinear(images, size[<span style="color:#ae81ff">0</span>], size[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">2</span>)
    resized <span style="color:#f92672">=</span> _resize_by_axis_trilinear(resized, size[<span style="color:#ae81ff">0</span>], size[<span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">return</span> resized


<span style="color:#75715e"># jumping some lines...</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">resize_multilinear_tf</span>(images, size):
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    Resize images to size using multilinear interpolation.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        :param images: A tensor with shape </span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">                        [batch, d0, ..., dn, channels]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        :param size: A 1-D int32 Tensor. The new size for the images.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    </span><span style="color:#e6db74">&#34;&#34;&#34;</span>
    <span style="color:#66d9ef">if</span> size<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
        resized <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>image<span style="color:#f92672">.</span>resize_bilinear(images, size)
    <span style="color:#66d9ef">elif</span> size<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>:
        resized <span style="color:#f92672">=</span> resize_trilinear(images, size)
    <span style="color:#66d9ef">elif</span> size<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
        resized <span style="color:#f92672">=</span> resize_tetralinear(images, size)
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">NotImplementedError</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">resize_multilinear_tf: dimensions </span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#e6db74">                                    higuer than 4 are not supported.</span><span style="color:#e6db74">&#39;</span>)
    <span style="color:#66d9ef">return</span> resized
</code></pre></div>
      </div>

      <footer>
        


        
        
        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
      <p>Let's do stuff together.</p>
    
    
      
        © 2019 - 2020
      
       Vicente Guerrero 
    
    
       · 
      Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
